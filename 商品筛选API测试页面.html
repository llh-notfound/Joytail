<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å“ç­›é€‰APIæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>PetPal å•†å“ç­›é€‰APIæµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>APIåŸºç¡€ä¿¡æ¯</h2>
        <p><strong>åŸºç¡€URL:</strong> https://udrvmlsoncfg.sealosbja.site/api</p>
        <p><strong>æ¥å£:</strong> /goods/list</p>
        <p><strong>æ”¯æŒçš„åˆ†ç±»:</strong> çŒ«ç²®, ç‹—ç²®, ç©å…·, é›¶é£Ÿ, æŠ¤æ¯›ç´ , çŒ«ç ‚, é™¤è‡­å‰‚, æ²æµ´éœ²</p>
    </div>

    <div class="test-section">
        <h2>å¿«é€Ÿæµ‹è¯•</h2>
        <button class="test-button" onclick="testBasicList()">åŸºç¡€å•†å“åˆ—è¡¨</button>
        <button class="test-button" onclick="testCategoryFilter('çŒ«ç²®')">çŒ«ç²®åˆ†ç±»</button>
        <button class="test-button" onclick="testCategoryFilter('ç‹—ç²®')">ç‹—ç²®åˆ†ç±»</button>
        <button class="test-button" onclick="testPriceFilter(50, 100)">ä»·æ ¼50-100å…ƒ</button>
        <button class="test-button" onclick="testSearch('çŒ«ç²®')">æœç´¢"çŒ«ç²®"</button>
        <button class="test-button" onclick="testSort('price_asc')">ä»·æ ¼å‡åº</button>
        <button class="test-button" onclick="testComplexFilter()">ç»„åˆç­›é€‰</button>
    </div>

    <div class="test-section">
        <h2>è‡ªå®šä¹‰æµ‹è¯•</h2>
        <div>
            <label>åˆ†ç±»: <input type="text" id="customCategory" placeholder="ä¾‹å¦‚: çŒ«ç²®"></label>
            <label>å“ç‰Œ: <input type="text" id="customBrand" placeholder="ä¾‹å¦‚: çš‡å®¶"></label>
            <label>å…³é”®è¯: <input type="text" id="customKeyword" placeholder="æœç´¢å…³é”®è¯"></label>
            <br><br>
            <label>æœ€ä½ä»·æ ¼: <input type="number" id="customMinPrice" placeholder="ä¾‹å¦‚: 50"></label>
            <label>æœ€é«˜ä»·æ ¼: <input type="number" id="customMaxPrice" placeholder="ä¾‹å¦‚: 200"></label>
            <label>æ’åº: 
                <select id="customSort">
                    <option value="">é»˜è®¤</option>
                    <option value="price_asc">ä»·æ ¼å‡åº</option>
                    <option value="price_desc">ä»·æ ¼é™åº</option>
                    <option value="sales_desc">é”€é‡é™åº</option>
                </select>
            </label>
            <br><br>
            <button class="test-button" onclick="testCustomFilter()">æ‰§è¡Œè‡ªå®šä¹‰æµ‹è¯•</button>
        </div>
    </div>

    <div id="results"></div>

    <script>
        const API_BASE = 'https://udrvmlsoncfg.sealosbja.site/api';
        
        function addResult(title, content, isError = false) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${isError ? 'error' : 'success'}`;
            
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <pre>${typeof content === 'string' ? content : JSON.stringify(content, null, 2)}</pre>
            `;
            
            resultsDiv.insertBefore(resultDiv, resultsDiv.firstChild);
        }
        
        async function makeAPIRequest(params) {
            const url = new URL(`${API_BASE}/goods/list`);
            Object.keys(params).forEach(key => {
                if (params[key] !== undefined && params[key] !== '') {
                    url.searchParams.append(key, params[key]);
                }
            });
            
            console.log('è¯·æ±‚URL:', url.toString());
            
            try {
                const response = await fetch(url.toString());
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${data.message || 'è¯·æ±‚å¤±è´¥'}`);
                }
                
                return data;
            } catch (error) {
                console.error('APIè¯·æ±‚å¤±è´¥:', error);
                throw error;
            }
        }
        
        async function testBasicList() {
            try {
                const result = await makeAPIRequest({ page: 1, pageSize: 5 });
                addResult('âœ… åŸºç¡€å•†å“åˆ—è¡¨æµ‹è¯•', result);
            } catch (error) {
                addResult('âŒ åŸºç¡€å•†å“åˆ—è¡¨æµ‹è¯•å¤±è´¥', error.message, true);
            }
        }
        
        async function testCategoryFilter(category) {
            try {
                const result = await makeAPIRequest({ category, page: 1, pageSize: 5 });
                addResult(`âœ… åˆ†ç±»ç­›é€‰æµ‹è¯• - ${category}`, result);
            } catch (error) {
                addResult(`âŒ åˆ†ç±»ç­›é€‰æµ‹è¯•å¤±è´¥ - ${category}`, error.message, true);
            }
        }
        
        async function testPriceFilter(minPrice, maxPrice) {
            try {
                const result = await makeAPIRequest({ minPrice, maxPrice, page: 1, pageSize: 5 });
                addResult(`âœ… ä»·æ ¼ç­›é€‰æµ‹è¯• - ${minPrice}-${maxPrice}å…ƒ`, result);
            } catch (error) {
                addResult(`âŒ ä»·æ ¼ç­›é€‰æµ‹è¯•å¤±è´¥ - ${minPrice}-${maxPrice}å…ƒ`, error.message, true);
            }
        }
        
        async function testSearch(keyword) {
            try {
                const result = await makeAPIRequest({ keyword, page: 1, pageSize: 5 });
                addResult(`âœ… æœç´¢æµ‹è¯• - "${keyword}"`, result);
            } catch (error) {
                addResult(`âŒ æœç´¢æµ‹è¯•å¤±è´¥ - "${keyword}"`, error.message, true);
            }
        }
        
        async function testSort(sortBy) {
            try {
                const result = await makeAPIRequest({ sortBy, page: 1, pageSize: 5 });
                addResult(`âœ… æ’åºæµ‹è¯• - ${sortBy}`, result);
            } catch (error) {
                addResult(`âŒ æ’åºæµ‹è¯•å¤±è´¥ - ${sortBy}`, error.message, true);
            }
        }
        
        async function testComplexFilter() {
            try {
                const params = {
                    category: 'çŒ«ç²®',
                    minPrice: 30,
                    maxPrice: 150,
                    sortBy: 'price_asc',
                    page: 1,
                    pageSize: 3
                };
                const result = await makeAPIRequest(params);
                addResult('âœ… ç»„åˆç­›é€‰æµ‹è¯•', { params, result });
            } catch (error) {
                addResult('âŒ ç»„åˆç­›é€‰æµ‹è¯•å¤±è´¥', error.message, true);
            }
        }
        
        async function testCustomFilter() {
            const params = {
                page: 1,
                pageSize: 5
            };
            
            const category = document.getElementById('customCategory').value;
            const brand = document.getElementById('customBrand').value;
            const keyword = document.getElementById('customKeyword').value;
            const minPrice = document.getElementById('customMinPrice').value;
            const maxPrice = document.getElementById('customMaxPrice').value;
            const sortBy = document.getElementById('customSort').value;
            
            if (category) params.category = category;
            if (brand) params.brand = brand;
            if (keyword) params.keyword = keyword;
            if (minPrice) params.minPrice = parseInt(minPrice);
            if (maxPrice) params.maxPrice = parseInt(maxPrice);
            if (sortBy) params.sortBy = sortBy;
            
            try {
                const result = await makeAPIRequest(params);
                addResult('âœ… è‡ªå®šä¹‰ç­›é€‰æµ‹è¯•', { params, result });
            } catch (error) {
                addResult('âŒ è‡ªå®šä¹‰ç­›é€‰æµ‹è¯•å¤±è´¥', error.message, true);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•åŸºç¡€åŠŸèƒ½
        window.onload = function() {
            addResult('ğŸ“‹ æµ‹è¯•é¡µé¢å·²åŠ è½½', 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•å•†å“ç­›é€‰APIåŠŸèƒ½');
        };
    </script>
</body>
</html>
