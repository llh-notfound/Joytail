# PetPal 商品筛选后端请求格式详解

## 🎯 请求基本信息

### API地址
```
GET https://udrvmlsoncfg.sealosbja.site/api/goods/list
```

### 请求方式
```
GET (查询参数通过URL传递)
```

### 请求头
```
Content-Type: application/json
```

## 📋 完整参数列表

### 基础参数（必传）
```javascript
{
  page: 1,           // 页码，从1开始
  pageSize: 10       // 每页数量，默认10
}
```

### 筛选参数（可选）
```javascript
{
  // 商品分类筛选
  category: "猫粮",   // 可选值: 猫粮|狗粮|玩具|零食|护毛素|猫砂|除臭剂|沐浴露
  
  // 品牌筛选  
  brand: "皇家",      // 可选值: 皇家|冠能|宝路|萌能|麦富迪
  
  // 搜索关键词
  keyword: "猫粮",    // 用户输入的搜索关键词
  
  // 价格区间筛选
  minPrice: 50,       // 最低价格
  maxPrice: 100,      // 最高价格（如果是"200元以上"，则不传maxPrice）
  
  // 排序方式
  sortBy: "price_asc" // 可选值: price_asc|price_desc|sales_desc
}
```

## 🔍 具体筛选场景示例

### 场景1：仅选择分类"猫粮"
```http
GET /api/goods/list?page=1&pageSize=10&category=猫粮
```

**对应前端操作：**
1. 点击筛选按钮
2. 选择分类"猫粮"  
3. 点击确定

**前端参数对象：**
```javascript
{
  page: 1,
  pageSize: 10,
  category: "猫粮"
}
```

### 场景2：分类+品牌+价格区间筛选
```http
GET /api/goods/list?page=1&pageSize=10&category=猫粮&brand=皇家&minPrice=50&maxPrice=200
```

**对应前端操作：**
1. 点击筛选按钮
2. 选择分类"猫粮"
3. 选择品牌"皇家"
4. 选择价格区间"50-200元"
5. 点击确定

**前端参数对象：**
```javascript
{
  page: 1,
  pageSize: 10,
  category: "猫粮",
  brand: "皇家",
  minPrice: 50,
  maxPrice: 200
}
```

### 场景3：搜索关键词
```http
GET /api/goods/list?page=1&pageSize=10&keyword=猫粮
```

**对应前端操作：**
1. 在搜索框输入"猫粮"
2. 按回车键

**前端参数对象：**
```javascript
{
  page: 1,
  pageSize: 10,
  keyword: "猫粮"
}
```

### 场景4：价格排序
```http
GET /api/goods/list?page=1&pageSize=10&sortBy=price_asc
```

**对应前端操作：**
1. 点击"价格"排序按钮

**前端参数对象：**
```javascript
{
  page: 1,
  pageSize: 10,
  sortBy: "price_asc"
}
```

### 场景5：复杂组合筛选
```http
GET /api/goods/list?page=1&pageSize=10&category=狗粮&brand=冠能&minPrice=30&maxPrice=150&keyword=成犬&sortBy=sales_desc
```

**对应前端操作：**
1. 搜索框输入"成犬"
2. 打开筛选弹窗
3. 选择分类"狗粮"
4. 选择品牌"冠能"  
5. 设置价格区间30-150元
6. 点击确定
7. 点击"销量"排序

**前端参数对象：**
```javascript
{
  page: 1,
  pageSize: 10,
  category: "狗粮",
  brand: "冠能", 
  minPrice: 30,
  maxPrice: 150,
  keyword: "成犬",
  sortBy: "sales_desc"
}
```

## 🔧 前端代码实现

### 参数构建逻辑
```javascript
const buildRequestParams = () => {
  // 基础参数
  const params = {
    page: currentPage.value,
    pageSize: pageSize
  }
  
  // 搜索关键词
  if (searchKeyword.value && searchKeyword.value.trim()) {
    params.keyword = searchKeyword.value.trim()
  }
  
  // 分类筛选
  if (selectedCategory.value && selectedCategory.value !== '全部') {
    params.category = selectedCategory.value
  }
  
  // 品牌筛选
  if (selectedBrand.value && selectedBrand.value !== '全部') {
    params.brand = selectedBrand.value
  }
  
  // 价格区间筛选
  if (selectedPriceRange.value) {
    params.minPrice = selectedPriceRange.value.min
    if (selectedPriceRange.value.max !== Infinity) {
      params.maxPrice = selectedPriceRange.value.max
    }
  }
  
  // 排序参数
  if (sortType.value === 'sales') {
    params.sortBy = 'sales_desc'
  } else if (sortType.value === 'price') {
    params.sortBy = priceOrder.value === 'asc' ? 'price_asc' : 'price_desc'
  }
  
  return params
}
```

### API调用
```javascript
const loadData = async () => {
  const params = buildRequestParams()
  
  console.log('🔍 [商品筛选] 发送API请求:', params)
  console.log('🔍 [商品筛选] 完整URL:', `${BASE_URL}/goods/list?${new URLSearchParams(params)}`)
  
  try {
    const response = await goodsApi.getGoodsList(params)
    console.log('✅ [商品筛选] API响应:', response)
    
    // 处理响应数据...
  } catch (error) {
    console.error('❌ [商品筛选] API请求失败:', error)
  }
}
```

## 📊 期望的后端响应格式

### 成功响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 156,
    "items": [
      {
        "id": 1,
        "name": "皇家猫粮 成猫专用 2kg",
        "price": 89.9,
        "sales": 1250,
        "brand": "皇家",
        "category": "猫粮",
        "image": "https://example.com/image1.jpg",
        "brief": "优质猫粮，营养均衡"
      },
      {
        "id": 2,
        "name": "冠能狗粮 大型犬专用 5kg", 
        "price": 158.8,
        "sales": 890,
        "brand": "冠能",
        "category": "狗粮",
        "image": "https://example.com/image2.jpg",
        "brief": "适合大型犬的营养狗粮"
      }
    ]
  }
}
```

### 错误响应
```json
{
  "code": 400,
  "message": "参数错误",
  "data": null
}
```

## 🛠️ 调试方法

### 1. 浏览器Network查看
1. 打开开发者工具 → Network选项卡
2. 进行筛选操作
3. 查看请求详情

### 2. Console日志查看
```javascript
// 在浏览器Console中可以看到：
🔍 [商品筛选] 发送API请求: {page: 1, pageSize: 10, category: "猫粮"}
🔍 [商品筛选] API URL: https://udrvmlsoncfg.sealosbja.site/api/goods/list
✅ [商品筛选] API响应: {code: 200, data: {...}}
```

### 3. 参数验证
```javascript
// 检查参数是否正确构建
const params = {
  page: 1,
  pageSize: 10,
  category: "猫粮",    // ✅ 正确
  brand: "皇家",       // ✅ 正确  
  minPrice: 50,        // ✅ 正确
  maxPrice: 100,       // ✅ 正确
  keyword: "成犬",     // ✅ 正确
  sortBy: "price_asc"  // ✅ 正确
}
```

## 🎯 关键要点

1. **所有筛选条件都通过URL查询参数传递**
2. **参数名称与后端API文档保持一致**  
3. **分类和品牌使用中文值**
4. **价格区间使用minPrice/maxPrice数字**
5. **排序使用英文标识符**
6. **分页从1开始计数**

现在当您在PetPal应用中进行任何筛选操作时，都会发送包含正确参数的HTTP请求到后端！🚀
